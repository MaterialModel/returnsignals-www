---
export interface FAQItem {
  question: string
  /** Answer can include HTML for links */
  answerHtml: string
  /** Plain text version for schema (no HTML) */
  answerText: string
}

interface Props {
  items: FAQItem[]
  title?: string
  description?: string
}

const { items, title = 'Frequently Asked Questions', description } = Astro.props
---

<section id="faq" class="py-16 sm:py-20 mathjax-ignore">
  <div class="container-narrow">
    <div class="text-center mb-12">
      <h2 class="text-2xl sm:text-3xl font-bold text-primary mb-4">
        {title}
      </h2>
      {description && <p class="text-secondary max-w-2xl mx-auto">{description}</p>}
    </div>

    <div class="space-y-4">
      {
        items.map((item) => (
          <details class="group bg-surface-base border border-border rounded-lg">
            <summary class="flex items-center justify-between p-5 cursor-pointer list-none">
              <h3 class="text-base font-semibold text-primary pr-4">{item.question}</h3>
              <svg
                class="w-5 h-5 text-tertiary transition-transform group-open:rotate-180 flex-shrink-0"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="2"
                stroke="currentColor"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </summary>
            <div class="px-5 pb-5 text-sm text-secondary">
              <p set:html={item.answerHtml} />
            </div>
          </details>
        ))
      }
    </div>
  </div>
</section>

<!-- FAQPage Schema -->
<script
  type="application/ld+json"
  set:html={JSON.stringify({
    '@context': 'https://schema.org',
    '@type': 'FAQPage',
    mainEntity: items.map((item) => ({
      '@type': 'Question',
      name: item.question,
      acceptedAnswer: {
        '@type': 'Answer',
        text: item.answerText,
      },
    })),
  })}
/>
