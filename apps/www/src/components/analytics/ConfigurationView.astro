---
/**
 * Configuration View - Best-in-class brand voice and policies configuration
 * Two-column layout: Settings (left) | Live Preview (right)
 */

import SMSMockup from "@components/ui/SMSMockup.astro";

const previewMessages = [
  {
    type: "incoming" as const,
    text: "Hi Jacky! Quick check-in—how's the new wrap dress fitting so far?",
  },
  {
    type: "outgoing" as const,
    text: "The neckline gaps more than I expected",
  },
  {
    type: "incoming" as const,
    text: "That's a common wrap-dress thing. Try tightening the inner tie first for a snugger base.",
  },
];
---

<div class="configuration-view">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Left Column: Settings -->
    <div class="config-settings space-y-4">
      <!-- Voice & Tone Section (Expanded by default) -->
      <div
        class="config-section bg-surface-base border-2 border-accent-primary/30 rounded-lg overflow-hidden"
      >
        <div class="p-4 bg-accent-primary/5">
          <div class="flex items-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 text-accent-primary"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
              ></path>
            </svg>
            <h3 class="text-sm font-semibold text-primary">Voice & Tone</h3>
            <span class="text-xs text-accent-primary">⭐ Start here</span>
          </div>
        </div>
        <div class="p-4 space-y-4">
          <!-- Tone Presets with visual examples -->
          <div class="setting-group">
            <label class="text-xs font-medium text-secondary mb-2 block"
              >Select Tone</label
            >
            <div class="space-y-2">
              <label
                class="tone-card flex items-start gap-3 p-3 border-2 border-accent-primary bg-accent-primary/5 rounded-lg cursor-pointer transition-all"
              >
                <input
                  type="radio"
                  name="tone"
                  value="friendly"
                  checked
                  class="mt-1"
                />
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="text-sm font-semibold text-primary"
                      >Friendly & Helpful</span
                    >
                    <span class="text-xs text-accent-primary">⭐</span>
                  </div>
                  <p class="text-xs text-secondary italic">
                    "Hi Jacky! Quick check-in—how's the new wrap dress fitting
                    so far?"
                  </p>
                </div>
              </label>
              <label
                class="tone-card flex items-start gap-3 p-3 border border-border bg-surface-base rounded-lg cursor-pointer hover:border-accent-primary/50 transition-all"
              >
                <input
                  type="radio"
                  name="tone"
                  value="professional"
                  class="mt-1"
                />
                <div class="flex-1">
                  <div class="text-sm font-semibold text-primary mb-1">
                    Professional
                  </div>
                  <p class="text-xs text-secondary italic">
                    "Hello Jacky. We're following up regarding your recent
                    order. How is the fit?"
                  </p>
                </div>
              </label>
              <label
                class="tone-card flex items-start gap-3 p-3 border border-border bg-surface-base rounded-lg cursor-pointer hover:border-accent-primary/50 transition-all"
              >
                <input type="radio" name="tone" value="casual" class="mt-1" />
                <div class="flex-1">
                  <div class="text-sm font-semibold text-primary mb-1">
                    Casual
                  </div>
                  <p class="text-xs text-secondary italic">
                    "Hey Jacky! Just checking in on that wrap dress. How's it
                    working out?"
                  </p>
                </div>
              </label>
            </div>
          </div>

          <!-- Answer Length -->
          <div class="setting-group">
            <label class="text-xs font-medium text-secondary mb-2 block"
              >Answer Length</label
            >
            <div class="flex gap-2">
              <button
                class="px-3 py-2 text-xs border border-border rounded bg-surface-base text-secondary hover:border-accent-primary/50 transition-colors"
                >Concise</button
              >
              <button
                class="px-3 py-2 text-xs border-2 border-accent-primary rounded bg-accent-primary/5 text-accent-primary font-medium"
                >Standard ⭐</button
              >
              <button
                class="px-3 py-2 text-xs border border-border rounded bg-surface-base text-secondary hover:border-accent-primary/50 transition-colors"
                >Detailed</button
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Response Procedures Section -->
      <div
        class="config-section bg-surface-base border border-border rounded-lg overflow-hidden"
      >
        <div class="p-4 bg-surface-subtle">
          <div class="flex items-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 text-accent-primary"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
              ></path>
            </svg>
            <h3 class="text-sm font-semibold text-primary">
              Response Procedures
            </h3>
          </div>
        </div>
        <div class="p-4 space-y-3">
          <div class="flex items-center justify-between mb-3">
            <p class="text-xs text-secondary">
              Define how the agent handles common scenarios
            </p>
            <button
              class="flex items-center gap-1 px-2 py-1 text-xs text-accent-primary hover:bg-accent-primary/10 rounded transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3.5 w-3.5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M12 4v16m8-8H4"></path>
              </svg>
              Add new rule
            </button>
          </div>

          <div
            class="procedure-card p-3 bg-surface-subtle rounded-lg border border-border hover:border-accent-primary/50 cursor-pointer transition-all"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium text-primary"
                >Fit & Sizing Issues</span
              >
              <div class="flex items-center gap-2">
                <button class="text-xs text-accent-primary hover:underline"
                  >Edit</button
                >
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" checked class="sr-only peer" />
                  <div
                    class="w-9 h-5 bg-surface-elevated peer-checked:bg-accent-primary rounded-full peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all"
                  >
                  </div>
                </label>
              </div>
            </div>
            <ol class="text-xs text-secondary space-y-1 ml-4 list-decimal">
              <li>Provide troubleshooting & styling tips</li>
              <li>If unresolved → offer size exchange</li>
              <li>If still unsatisfied → process return</li>
            </ol>
          </div>

          <div
            class="procedure-card p-3 bg-surface-subtle rounded-lg border border-border hover:border-accent-primary/50 cursor-pointer transition-all"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium text-primary"
                >Defect Complaints</span
              >
              <div class="flex items-center gap-2">
                <button class="text-xs text-accent-primary hover:underline"
                  >Edit</button
                >
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" checked class="sr-only peer" />
                  <div
                    class="w-9 h-5 bg-surface-elevated peer-checked:bg-accent-primary rounded-full peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all"
                  >
                  </div>
                </label>
              </div>
            </div>
            <ol class="text-xs text-secondary space-y-1 ml-4 list-decimal">
              <li>Request photo for verification</li>
              <li>If confirmed → offer exchange or refund</li>
              <li>If not visible → ask for clarification</li>
            </ol>
          </div>

          <div
            class="procedure-card p-3 bg-surface-subtle rounded-lg border border-border hover:border-accent-primary/50 cursor-pointer transition-all"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium text-primary"
                >At-Customer Disposal</span
              >
              <div class="flex items-center gap-2">
                <button class="text-xs text-accent-primary hover:underline"
                  >Edit</button
                >
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" checked class="sr-only peer" />
                  <div
                    class="w-9 h-5 bg-surface-elevated peer-checked:bg-accent-primary rounded-full peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all"
                  >
                  </div>
                </label>
              </div>
            </div>
            <div class="text-xs text-secondary">
              <div class="mb-1">Recommend when:</div>
              <ul class="ml-4 space-y-0.5">
                <li>
                  • Item value &lt; <span class="font-medium text-primary"
                    >$25</span
                  > AND severe damage
                </li>
                <li>
                  • Reverse logistics cost &gt; <span
                    class="font-medium text-primary">40%</span
                  > of value
                </li>
              </ul>
            </div>
          </div>

          <div
            class="procedure-card p-3 bg-surface-subtle rounded-lg border border-border hover:border-accent-primary/50 cursor-pointer transition-all"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium text-primary"
                >Escalation to Human</span
              >
              <div class="flex items-center gap-2">
                <button class="text-xs text-accent-primary hover:underline"
                  >Edit</button
                >
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" checked class="sr-only peer" />
                  <div
                    class="w-9 h-5 bg-surface-elevated peer-checked:bg-accent-primary rounded-full peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all"
                  >
                  </div>
                </label>
              </div>
            </div>
            <div class="text-xs text-secondary">
              <div class="mb-1">Hand off when:</div>
              <ul class="ml-4 space-y-0.5">
                <li>• Customer requests human agent</li>
                <li>
                  • <span class="font-medium text-primary">3+</span> exchanges without
                  resolution
                </li>
                <li>• Sentiment analysis shows frustration</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Response Templates Section -->
      <div
        class="config-section bg-surface-base border border-border rounded-lg overflow-hidden"
      >
        <div class="p-4 bg-surface-subtle">
          <div class="flex items-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 text-accent-primary"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"
              ></path>
            </svg>
            <h3 class="text-sm font-semibold text-primary">
              Response Templates
            </h3>
          </div>
        </div>
        <div class="p-4 space-y-2">
          <div
            class="template-item p-3 border border-border rounded-lg hover:border-accent-primary/50 cursor-pointer transition-colors"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="text-xs font-medium text-primary"
                >Initial Check-in</span
              >
              <button class="text-xs text-accent-primary hover:underline"
                >Edit</button
              >
            </div>
            <p class="text-xs text-secondary">
              "Hi [Name]! Quick check-in—how's the new [Product] fitting so
              far?"
            </p>
          </div>
          <div
            class="template-item p-3 border border-border rounded-lg hover:border-accent-primary/50 cursor-pointer transition-colors"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="text-xs font-medium text-primary">Photo Request</span
              >
              <button class="text-xs text-accent-primary hover:underline"
                >Edit</button
              >
            </div>
            <p class="text-xs text-secondary">
              "Can you snap a quick photo of [issue area] so I can confirm
              this?"
            </p>
          </div>
          <div
            class="template-item p-3 border border-border rounded-lg hover:border-accent-primary/50 cursor-pointer transition-colors"
          >
            <div class="flex items-center justify-between mb-2">
              <span class="text-xs font-medium text-primary"
                >Exchange Offer</span
              >
              <button class="text-xs text-accent-primary hover:underline"
                >Edit</button
              >
            </div>
            <p class="text-xs text-secondary">
              "Want me to set up a fast exchange so you get a better one?"
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column: Live Preview -->
    <div class="config-preview">
      <div
        class="bg-surface-base border border-border rounded-lg p-5 sticky top-0"
      >
        <h3 class="text-sm font-semibold text-primary mb-3">Live Preview</h3>
        <p class="text-xs text-secondary mb-4">
          See how your settings affect customer interactions
        </p>

        <!-- Preview SMS Mockup (reusing existing component) -->
        <SMSMockup messages={previewMessages} contactName="Return Signals" />

        <!-- Tone Impact Callout -->
        <div
          class="mt-4 p-3 bg-accent-primary/5 rounded-lg border border-accent-primary/20"
        >
          <div class="flex items-start gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 text-accent-primary flex-shrink-0 mt-0.5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
              ></path>
            </svg>
            <div>
              <div class="text-xs font-medium text-accent-primary mb-1">
                Tone Impact
              </div>
              <div class="text-xs text-secondary">
                Current: <span class="font-semibold text-primary"
                  >Friendly & Helpful</span
                > — Warm, proactive, solves problems while building trust
              </div>
            </div>
          </div>
        </div>

        <!-- Test Different Scenarios -->
        <div class="mt-4">
          <label class="text-xs font-medium text-secondary mb-2 block"
            >Test Scenario</label
          >
          <select
            class="w-full px-3 py-2 text-xs border border-border rounded bg-surface-base text-primary"
          >
            <option>Fit issue (current)</option>
            <option>Defect complaint</option>
            <option>Generic concern</option>
            <option>Escalation request</option>
          </select>
        </div>
      </div>
    </div>
  </div>
</div>
