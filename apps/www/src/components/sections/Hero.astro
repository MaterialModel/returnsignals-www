---
import FullViewportSection from '@layouts/FullViewportSection.astro'
import SMSMockup from '@components/ui/SMSMockup.astro'

interface Props {
  ctaUrl: string
  blogBadge?: string
}

const { ctaUrl, blogBadge } = Astro.props

// Message type definition
type Message = {
  type: 'incoming' | 'outgoing'
  content?: 'text' | 'image'
  text?: string
  imageSrc?: string
  imageAlt?: string
  timestamp?: string
}

// Exchange conversation - Emma's dress exchange story
const heroMessages: Message[] = [
  {
    type: 'incoming' as const,
    text: "Hi Emma! Quick check-in—how's the new green wrap dress fitting so far?",
  },
  {
    type: 'outgoing' as const,
    text: "Haven't tried it on yet.",
  },
  {
    type: 'incoming' as const,
    text: "All good. I'll follow up in a few days so we can make sure it's perfect before you wear it.",
  },
  {
    type: 'incoming' as const,
    text: 'Checking back in—did you get a chance to try it on?',
  },
  {
    type: 'outgoing' as const,
    text: 'I tried it but I wish it was a little smaller and lighter green.',
  },
  {
    type: 'incoming' as const,
    text: 'Can you send a quick photo so I can see what you have?',
  },
  {
    type: 'outgoing' as const,
    content: 'image' as const,
    imageSrc: '/images/hero/dark-green-dress.jpg',
    imageAlt: 'Dark green wrap dress',
  },
  {
    type: 'incoming' as const,
    text: 'Got it! I found the same style in a lighter sage, size 6 instead of 8. Would you like to exchange?',
  },
  {
    type: 'incoming' as const,
    content: 'image' as const,
    imageSrc: '/images/hero/lighter-green-dress.jpg',
    imageAlt: 'Lighter green wrap dress',
  },
  {
    type: 'outgoing' as const,
    text: 'Yes!',
  },
  {
    type: 'incoming' as const,
    text: "Great! I'm setting up the exchange now. You'll get a return label for the current dress.",
  },
]
---

<FullViewportSection isFirst={true}>
  {
    blogBadge && (
      <div class="text-center mb-6 sm:absolute sm:top-12 sm:left-0 sm:right-0 sm:mb-0 z-10">
        <a
          href={blogBadge}
          class="group inline-flex items-center gap-2 bg-surface-subtle border border-border rounded-full px-3 py-1 text-sm text-secondary hover:text-primary hover:border-border-hover transition-colors"
        >
          <span class="bg-accent-primary text-inverse text-xs font-medium px-1.5 py-0.5 rounded-full">
            New
          </span>
          <span>The End of Reactive Support</span>
          <span class="text-tertiary group-hover:text-primary transition-colors">→</span>
        </a>
      </div>
    )
  }

  <div class="hero-content relative w-full max-w-5xl mx-auto sm:pt-24">
    <div
      class="flex flex-col lg:flex-row items-center lg:items-start justify-between gap-8 lg:gap-12"
    >
      <!-- Left: Text Content -->
      <div class="order-1 text-center lg:text-left max-w-xl lg:max-w-lg">
        <h1 class="hero-headline">
          Proactive CX for <span class="whitespace-nowrap">E-commerce</span>
        </h1>

        <p class="hero-tagline mt-6 lg:mx-0">
          Text post-delivery to provide support, preempt returns, and improve retention.
        </p>

        <div
          class="flex items-center justify-center lg:justify-start gap-3 sm:gap-4 mt-8 sm:mt-10 flex-wrap"
        >
          <a href={ctaUrl} target="_blank" rel="noopener noreferrer" class="btn btn-primary"
            >Book a Demo</a
          >
          <a href="#narrative-jacky" class="btn btn-secondary">See Examples</a>
        </div>

        <!-- Trust -->
        <div class="flex items-center justify-center lg:justify-start gap-3 mt-10 sm:mt-12">
          <span class="text-sm text-secondary">Backed by</span>
          <img src="/images/ycombinator.png" alt="Y Combinator" class="h-5" />
        </div>
      </div>

      <!-- Right: SMS Mockup -->
      <div class="order-2 lg:order-2 flex-none relative">
        <div class="hero-glow" aria-hidden="true"></div>
        <SMSMockup messages={heroMessages} className="hero-sms-mockup" autoplay={true} />
      </div>
    </div>
  </div>
</FullViewportSection>

<style>
  .hero-glow {
    position: absolute;
    top: -6%;
    right: -10%;
    width: 26rem;
    height: 26rem;
    border-radius: 9999px;
    background: radial-gradient(
      closest-side,
      var(--color-accent-primary) 0%,
      rgba(15, 23, 42, 0.15) 35%,
      rgba(15, 23, 42, 0) 70%
    );
    filter: blur(50px);
    opacity: 0.35;
    pointer-events: none;
    z-index: 0;
  }
  .hero-sms-mockup {
    position: relative;
    z-index: 1;
  }
  @media (min-width: 640px) {
    .hero-glow {
      width: 30rem;
      height: 30rem;
      top: -8%;
      right: -12%;
      filter: blur(60px);
      opacity: 0.4;
    }
  }
  @media (min-width: 1024px) {
    .hero-glow {
      width: 34rem;
      height: 34rem;
      top: -10%;
      right: -16%;
      filter: blur(70px);
    }
    /* vh-based padding: tune the 900px value below */
    .hero-content {
      padding-top: 0;
    }
    @media (max-height: 750px) {
      .hero-content {
        padding-top: 8rem;
      }
    }
  }
</style>
