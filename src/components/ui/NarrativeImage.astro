---
interface Props {
  src: string
  alt: string
  story: string
  className?: string
  heightClasses?: string // Tailwind height classes for wrapper
}

const {
  src,
  alt,
  story,
  className = '',
  heightClasses = 'h-[400px] sm:h-[450px] md:h-[500px]',
} = Astro.props
---

<div class={`narrative-image ${className}`}>
  <div class={`narrative-crop relative w-full overflow-hidden ${heightClasses}`}>
    <img
      src={src}
      alt={alt}
      loading="lazy"
      class="block h-full w-full object-cover object-top"
      style="mask-image: linear-gradient(to bottom, white var(--fade-start, 58%), transparent 100%); -webkit-mask-image: linear-gradient(to bottom, white var(--fade-start, 58%), transparent 100%);"
    />
    <div class="absolute inset-x-8 sm:inset-x-12 top-1/2 -translate-y-1/2">
      <p
        class="leading-relaxed italic font-medium text-center"
        style="font-family: Georgia, 'Times New Roman', serif;
        color: #1F2937;
        text-shadow: 0 0 20px rgba(255,255,255,1), 0 0 40px rgba(255,255,255,0.8), 4px 4px 8px rgba(255,255,255,0.9), -4px -4px 8px rgba(255,255,255,0.9);
        font-size: 1.3rem;
        line-height: 1.5;"
      >
        {story}
      </p>
    </div>
  </div>
</div>

<style>
  /* Defaults for bottom fade position by breakpoint */
  .narrative-crop { --fade-start: 60%; }
  @media (min-width: 640px) {
    .narrative-crop { --fade-start: 58%; }
  }
  @media (min-width: 768px) {
    .narrative-crop { --fade-start: 56%; }
  }

  /* Edge fades on all sides to blend into white */
  .narrative-crop::after {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    --edge-fade: 20px;
    background:
      linear-gradient(to bottom, rgba(255,255,255,1), rgba(255,255,255,0)) top/100% var(--edge-fade) no-repeat,
      linear-gradient(to top, rgba(255,255,255,1), rgba(255,255,255,0)) bottom/100% var(--edge-fade) no-repeat,
      linear-gradient(to right, rgba(255,255,255,1), rgba(255,255,255,0)) left/var(--edge-fade) 100% no-repeat,
      linear-gradient(to left, rgba(255,255,255,1), rgba(255,255,255,0)) right/var(--edge-fade) 100% no-repeat;
  }
</style>
