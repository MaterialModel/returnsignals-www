---
/**
 * NarrativeSection
 *
 * Reusable section for customer narratives (Jacky, Bob, Priya)
 * Features SMS mockup + narrative image in two-column layout
 */

import SMSMockup from '@components/ui/SMSMockup.astro'
import NarrativeImage from '@components/ui/NarrativeImage.astro'

interface Message {
  type: 'incoming' | 'outgoing' | 'image'
  text?: string
  imageSrc?: string
  imageAlt?: string
}

interface Props {
  header: string
  story: string
  messages: Message[]
  narrativeImage: string
  narrativeImageAlt: string
  callout?: string
  className?: string
  id?: string
}

const { header, story, messages, narrativeImage, narrativeImageAlt, callout, className = '', id } =
  Astro.props
---

<section {id} class={`bg-surface-base py-12 sm:py-16 ${className}`}>
  <div class="container-lg">
    <!-- Scrub zone: title + content pin together with fixed spacing -->
    <div
      class="sms-scrub-zone relative max-w-6xl mx-auto"
      style={`--title-offset: 72px; --title-gap: 16px; --sms-steps: ${messages.length}; --sms-step: 120px; --sms-hold: 24px; min-height: calc(100vh + var(--sms-step) * var(--sms-steps) + var(--sms-hold));`}
    >
      <div class="sticky top-0">
        <!-- Spacer to position title below top -->
        <div style="height: var(--title-offset)"></div>
        <h2 class="text-xl sm:text-2xl lg:text-3xl font-medium text-primary text-center">
          {header}
        </h2>
        <div class="mt-[var(--title-gap)] grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-8 items-center">
          <!-- SMS Mockup (pinned) -->
          <div class="order-2 lg:order-1">
            <SMSMockup {messages} />
          </div>

          <!-- Narrative Image (pinned) -->
          <div class="order-1 lg:order-2">
            <NarrativeImage src={narrativeImage} alt={narrativeImageAlt} story={story} />
          </div>
        </div>
      </div>
    </div>

    {
      callout && (
        <div class="mt-6 p-4 bg-accent-muted border-l-4 border-accent-primary rounded-r max-w-4xl mx-auto animate-on-scroll">
          <p class="text-sm text-secondary italic">{callout}</p>
        </div>
      )
    }
  </div>
</section>

